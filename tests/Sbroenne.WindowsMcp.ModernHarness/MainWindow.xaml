<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Sbroenne.WindowsMcp.ModernHarness.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MCP Windows Modern Test Harness">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- CommandBar (like modern Notepad/Paint toolbar) -->
        <CommandBar x:Name="MainCommandBar" 
                    Grid.Row="0" 
                    DefaultLabelPosition="Right"
                    AutomationProperties.AutomationId="MainCommandBar">
            <AppBarButton x:Name="NewButton" 
                          Icon="Add" 
                          Label="New"
                          AutomationProperties.AutomationId="NewButton"
                          Click="OnNewButtonClick"/>
            <AppBarButton x:Name="SaveButton" 
                          Icon="Save" 
                          Label="Save"
                          AutomationProperties.AutomationId="SaveButton"
                          Click="OnSaveButtonClick"
                          AccessKey="S"/>
            <AppBarSeparator/>
            <AppBarButton x:Name="CopyButton" 
                          Icon="Copy" 
                          Label="Copy"
                          AutomationProperties.AutomationId="CopyButton"
                          Click="OnCopyButtonClick"/>
            <AppBarButton x:Name="PasteButton" 
                          Icon="Paste" 
                          Label="Paste"
                          AutomationProperties.AutomationId="PasteButton"
                          Click="OnPasteButtonClick"/>
        </CommandBar>

        <!-- Main Content with NavigationView -->
        <NavigationView x:Name="MainNavView"
                        Grid.Row="1"
                        IsBackButtonVisible="Collapsed"
                        IsSettingsVisible="False"
                        PaneDisplayMode="Left"
                        OpenPaneLength="200"
                        SelectionChanged="OnNavViewSelectionChanged"
                        AutomationProperties.AutomationId="MainNavView">

            <NavigationView.MenuItems>
                <NavigationViewItem x:Name="NavHome" 
                                    Content="Home" 
                                    Tag="Home"
                                    AutomationProperties.AutomationId="NavHome">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Home"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem x:Name="NavFormControls" 
                                    Content="Form Controls" 
                                    Tag="FormControls"
                                    AutomationProperties.AutomationId="NavFormControls">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Edit"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
                <NavigationViewItem x:Name="NavEditor" 
                                    Content="Editor" 
                                    Tag="Editor"
                                    AutomationProperties.AutomationId="NavEditor">
                    <NavigationViewItem.Icon>
                        <SymbolIcon Symbol="Document"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <!-- Content Frame -->
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <Grid x:Name="ContentGrid" Padding="16">
                    
                    <!-- Home Page -->
                    <StackPanel x:Name="HomePage" Visibility="Visible" Spacing="16">
                        <TextBlock Text="MCP Windows Modern Test Harness"
                                   Style="{ThemeResource TitleTextBlockStyle}"/>
                        
                        <TextBlock x:Name="StatusLabel"
                                   Text="Ready"
                                   FontWeight="SemiBold"
                                   AutomationProperties.AutomationId="StatusLabel"/>

                        <!-- State Display for MCP verification -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="8">
                                <TextBlock Text="Current State" FontWeight="Bold"/>
                                
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Button Clicks:"/>
                                    <TextBlock x:Name="ButtonClicksDisplay" 
                                               Text="0"
                                               AutomationProperties.AutomationId="ButtonClicksDisplay"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Slider Value:"/>
                                    <TextBlock x:Name="SliderValueDisplay" 
                                               Text="50"
                                               AutomationProperties.AutomationId="SliderValueDisplay"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Checkbox:"/>
                                    <TextBlock x:Name="CheckboxStateDisplay" 
                                               Text="Unchecked"
                                               AutomationProperties.AutomationId="CheckboxStateDisplay"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Form Controls Page -->
                    <StackPanel x:Name="FormControlsPage" Visibility="Collapsed" Spacing="16">
                        <TextBlock Text="Form Controls"
                                   Style="{ThemeResource TitleTextBlockStyle}"/>

                        <!-- Text Input -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Text Input" FontWeight="Bold"/>
                                <TextBox x:Name="UsernameInput"
                                         Width="300"
                                         PlaceholderText="Enter username"
                                         AutomationProperties.AutomationId="UsernameInput"
                                         TextChanged="OnUsernameTextChanged"/>
                            </StackPanel>
                        </Border>

                        <!-- Buttons -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Actions" FontWeight="Bold"/>
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <Button x:Name="SubmitButton"
                                            Content="Submit"
                                            Style="{ThemeResource AccentButtonStyle}"
                                            AutomationProperties.AutomationId="SubmitButton"
                                            Click="OnSubmitButtonClick"/>
                                    <Button x:Name="CancelButton"
                                            Content="Cancel"
                                            AutomationProperties.AutomationId="CancelButton"
                                            Click="OnCancelButtonClick"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Checkbox -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Options" FontWeight="Bold"/>
                                <CheckBox x:Name="EnableNotificationsCheckbox"
                                          Content="Enable Notifications"
                                          AutomationProperties.AutomationId="EnableNotificationsCheckbox"
                                          Checked="OnCheckboxChanged"
                                          Unchecked="OnCheckboxChanged"/>
                            </StackPanel>
                        </Border>

                        <!-- Slider -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Volume" FontWeight="Bold"/>
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <Slider x:Name="VolumeSlider"
                                            Width="300"
                                            Minimum="0"
                                            Maximum="100"
                                            Value="50"
                                            AutomationProperties.AutomationId="VolumeSlider"
                                            ValueChanged="OnVolumeSliderChanged"/>
                                    <TextBlock x:Name="VolumeValueText"
                                               Text="50%"
                                               VerticalAlignment="Center"
                                               AutomationProperties.AutomationId="VolumeValueText"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- ComboBox -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Category" FontWeight="Bold"/>
                                <ComboBox x:Name="CategoryComboBox"
                                          Width="200"
                                          SelectedIndex="0"
                                          AutomationProperties.AutomationId="CategoryComboBox">
                                    <ComboBoxItem Content="Technology"/>
                                    <ComboBoxItem Content="Science"/>
                                    <ComboBoxItem Content="Art"/>
                                </ComboBox>
                            </StackPanel>
                        </Border>

                        <!-- ListView -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Project List" FontWeight="Bold"/>
                                <ListView x:Name="ProjectListView"
                                          Height="150"
                                          SelectionMode="Single"
                                          AutomationProperties.AutomationId="ProjectListView"
                                          SelectionChanged="OnProjectListSelectionChanged">
                                    <ListViewItem Content="Project Alpha"/>
                                    <ListViewItem Content="Project Beta"/>
                                    <ListViewItem Content="Project Gamma"/>
                                </ListView>
                                <TextBlock x:Name="SelectedProjectText"
                                           Text="Selected: (none)"
                                           AutomationProperties.AutomationId="SelectedProjectText"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Editor Page -->
                    <StackPanel x:Name="EditorPage" Visibility="Collapsed" Spacing="16">
                        <TextBlock Text="Editor"
                                   Style="{ThemeResource TitleTextBlockStyle}"/>

                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Text Editor" FontWeight="Bold"/>
                                <TextBox x:Name="EditorTextBox"
                                         Height="200"
                                         AcceptsReturn="True"
                                         TextWrapping="Wrap"
                                         FontFamily="Consolas"
                                         PlaceholderText="Type or paste text here..."
                                         AutomationProperties.AutomationId="EditorTextBox"
                                         TextChanged="OnEditorTextChanged"/>
                                <StackPanel Orientation="Horizontal" Spacing="16">
                                    <TextBlock x:Name="CharacterCountText"
                                               Text="Characters: 0"
                                               AutomationProperties.AutomationId="CharacterCountText"/>
                                    <TextBlock x:Name="WordCountText"
                                               Text="Words: 0"
                                               AutomationProperties.AutomationId="WordCountText"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- Click Testing -->
                        <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <StackPanel Spacing="12">
                                <TextBlock Text="Click Testing" FontWeight="Bold"/>
                                <Button x:Name="ClickTestButton"
                                        Content="Click Me"
                                        Width="120"
                                        Height="40"
                                        AutomationProperties.AutomationId="ClickTestButton"
                                        Click="OnClickTestButtonClick"/>
                                <TextBlock x:Name="ClickCountText"
                                           Text="Clicks: 0"
                                           AutomationProperties.AutomationId="ClickCountText"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                </Grid>
            </ScrollViewer>
        </NavigationView>

        <!-- Status Bar -->
        <Border Grid.Row="2"
                Background="{ThemeResource SystemAccentColorLight3}"
                Padding="12,8">
            <TextBlock x:Name="StatusBarText"
                       Text="Ready"
                       FontSize="12"
                       AutomationProperties.AutomationId="StatusBarText"/>
        </Border>
    </Grid>
</Window>
