# Agent-benchmark test: Notepad Automation Workflow
# Tests a complete Notepad automation workflow using handle-based window targeting.
# Migrated from skUnit: NotepadWorkflow.md

name: "Notepad Automation Workflow"
test_delay: 60s

mcp_servers:
  - name: windows-mcp
    command: "{{SERVER_PATH}}"

scenarios:
  - name: "Complete Notepad Workflow"
    model: "{{MODEL}}"
    system_prompt: |
      You are a Windows automation assistant. Use the available MCP tools to help users
      manage windows and automate tasks. Use explicit window handles for targeting specific windows.
    
    steps:
      - prompt: "Open Notepad for me."
        assertions:
          - tool_name: window_management
          - anyOf:
              - response_contains: Notepad
              - response_contains: open
              - response_contains: launched

      - prompt: 'Type "Hello from Windows MCP Server!" into that Notepad window.'
        assertions:
          # LLM may use keyboard_control or ui_automation to type text
          - anyOf:
              - allOf:
                  - tool_name: keyboard_control
                  - tool_call_contains: "Hello"
              - allOf:
                  - tool_name: ui_automation
                  - anyOf:
                      - tool_call_contains: '"action":"Type"'
                      - tool_call_contains: '"action":"setValue"'
                      - tool_call_contains: '"action": "Type"'
                      - tool_call_contains: '"action": "setValue"'
          - anyOf:
              - response_contains: typed
              - response_contains: Hello
              - response_contains: text

      - prompt: "Take a screenshot of Notepad showing what I typed."
        assertions:
          - tool_name: screenshot_control

      - prompt: "Is that Notepad window maximized or normal sized?"
        assertions:
          - tool_name: window_management
          - anyOf:
              - response_contains: normal
              - response_contains: minimized
              - response_contains: maximized
              - response_contains: Normal
              - response_contains: Minimized
              - response_contains: Maximized

      - prompt: "Close Notepad. Don't save the file."
        assertions:
          - tool_name: window_management
          - anyOf:
              - response_contains: closed
              - response_contains: Close

      - prompt: "Verify Notepad is no longer open."
        assertions:
          - tool_name: window_management
          - anyOf:
              - response_contains: "not found"
              - response_contains: "does not exist"
              - response_contains: none
              - response_contains: "no Notepad"
              - response_contains: "0 windows"
              - response_contains: "no windows"
